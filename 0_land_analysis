##### PACKAGES TO IMPORT 
import pandas as pd
import numpy as np
from scipy.optimize import minimize
import re
from matplotlib import pyplot as plt
import time

with open('bgi_information.txt') as file1:
    exec(file1.read())

with open('landcover_information.txt') as file2:
    exec(file2.read())

land_data = pd.read_csv('breda_land_data_text.txt', sep='\t', decimal=',')
land_data_df = pd.DataFrame(land_data)

# replacing zero values with 0.0001 
land_data_df = land_data_df.replace(0, 0.0001)
print(land_data_df)

# BASIC PARAMETERS
nbgi = len(types_bgi)
nlcv = len(types_landcover)

# separating landcover runoff from suitability (stored in last column)
landcover_mat = bgi_landcover_matrix[:,0:9]
runoff_coeffs = bgi_landcover_matrix[:,9]

total_cells = len(land_data_df)
total_land = land_data_df['area'].sum()
print(total_cells, total_land)

# separate cells by landcover 
landcover_areas = {}
for i, string in enumerate(land_data_df['landcover'].iloc[:]):
    if string in landcover_areas:
        landcover_areas[string] += land_data_df['area'].iloc[i]
    else:
        landcover_areas[string] = land_data_df['area'].iloc[i]

# stores in dictionary, so call on the total area of flat roofs by: landcover_areas['flat roof']

final_labels = landcover_areas.keys()
labels_arr = list(final_labels)
sizes = landcover_areas.values()
sizes_arr = list(sizes)

fig, ax = plt.subplots()
ax.pie(sizes, labels=final_labels)
plt.show()

for i in range(len(sizes)):
    print(f"{labels_arr[i]} --- {sizes_arr[i]:.2f} m2, --- {sizes_arr[i]/total_land*100:.1f} %")

estimate_of_land_only = land_data_df[
(land_data_df['landcover']!='other') 
& (land_data_df['landcover']!='water')
& (land_data_df['landcover']!='facade')]

sorted_df = estimate_of_land_only.sort_values(by='area', ascending=False)

fig, ax = plt.subplots()
plt.hist(land_data_df['area'], bins=100, density=True)
plt.title('Histogram of All Area')
plt.xlabel('Area')
plt.ylabel('Frequency')
plt.show()

fig, ax = plt.subplots()
plt.hist(np.sort(land_data_df['area'])[0:10000], bins=100, density=True)
plt.title('Histogram of Areas < 500 m2')
plt.xlabel('Area'); plt.xlim([0,500])
plt.ylabel('Frequency')
plt.show()

